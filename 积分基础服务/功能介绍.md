### 1.简介
积分Saas系统，提供围绕积分相关的如【积分发放】、【积分流水】、【积分消耗】、【积分统计】等基础功能的同时，支持【流水溯源】、【组合支付】等拓展功能。
针对【高并发】、【数据无限扩容】、【异步处理】、【请求合并】、【服务治理】等问题提供相应解决方案。

### 2.数据模型
#### 积分账户 （user_coin_account)
字段 | 描述 
--|:--:
id|主键
tenent_id | 租户id（分片键）
tenent_type|租户类型（KBS/APP等）
coin_type_id|积分类型id
coin_amount|积分余额

租户id+租户类型+积分类型id 为组合唯一索引，多账户之间数据隔离，本系统不做账户串联。期望多账户组合使用时需调用方传入【租户id+租户类型】集合 。

#### 积分获取流水 (user_coin_get)
字段|描述
-|:-
id|主键
coin_amount|积分数量
coint_type_id|积分类型id
account_id|积分账户id（分片键）
coin_remain|剩余积分数量
coin_empty|无可用积分（0否 1是）
coin_empty_time|无可用积分日期
coin_expired|过期积分数量
coin_expire_status|积分过期状态（0已过期 1未过期 2永久有效
record_id|积分变动记录id
record_time|积分变动记录日期（积分变动记录分片键）
该表仅记录获取积分流水，且每条流水记录剩余积分数量。当无可用积分日期超过==7天==后，记录转移至永久存储介质或删除，以此做冷热分离，限制数据增长速度。

同时，该表用于展示积分有效期记录，**当转移或删除后该条记录将不可见**。

#### 积分消耗流水 (user_coin_consume)
字段|描述
-|:-
id|主键
coin_amount|消耗积分数量
account_id|积分账户id（分片键）
coin_type_id|积分类型id
user_coin_get_id|获取积分流水id
user_record_id|积分变动记录id
back_coin_amount|已退回积分数量
该表仅记录消耗积分流水，每条消耗积分流水依赖于获取积分流水，用户退款总额最多不得超过该条记录消耗积分数量。随积分流水一并转移至永久存储介质或删除，以此做冷热分离，限制数据增长速度。**转移或删除后该条记录将不可退款**。

#### 积分变动记录
字段|描述

#### 积分类型

